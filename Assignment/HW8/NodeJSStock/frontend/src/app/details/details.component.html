<mat-spinner *ngIf="!metadata || !latestprice || !allnews" class="mt-5 mx-auto"></mat-spinner>

<!-- if ticker exists, show tab area -->
<div *ngIf="metadata && metadata.ticker && latestprice && allnews" class="container mt-5">
  <div class="detail-header">
    <div class="row">
      <div class="col">
        <h1 class="m-0 p-0 d-flex flex-row" id="meta-ticker">
          {{ metadata.ticker }}
        </h1>
        <h3 class="m-0 p-0 text-black-50 d-flex flex-row" id="meta-name">
          {{ metadata.name }}
        </h3>
        <h4 class="m-0 p-0 font-weight-light d-flex flex-row">
          {{ metadata.exchangeCode }}
        </h4>
      </div>
      <div class="col">
        <h1
          *ngIf="change > 0"
          class="m-0 p-0 d-flex flex-row-reverse text-success"
          id="latest-last-pos"
        >
          {{ latestprice.last }}
        </h1>
        <h1
          *ngIf="change < 0"
          class="m-0 p-0 d-flex flex-row-reverse text-danger"
          id="latest-last-neg"
        >
          {{ latestprice.last }}
        </h1>
        <!-- if change positive, green latest price -->
        <div *ngIf="changePercent > 0" class="row mr-1 flex-row justify-content-end">
          <div class="row m-0 p-0">
            <svg width="2em" height="2em" viewBox="0 0 16 16" class="bi bi-caret-up-fill" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
              <path class="pos" d="M7.247 4.86l-4.796 5.481c-.566.647-.106 1.659.753 1.659h9.592a1 1 0 0 0 .753-1.659l-4.796-5.48a1 1 0 0 0-1.506 0z"/>
            </svg>
            <h2 class="m-0 p-0 d-flex flex-row-reverse text-success" id="change-latest-pos">{{ change | number: "1.2-2" }}</h2>
          </div>
          <div class="col-sm m-0 p-0 col-md-auto"><h2 class="m-0 p-0 d-flex flex-row-reverse text-success" id="change-latest-pos">({{ changePercent | number: "1.2-2" }}%)</h2></div>
        </div>

        <!-- if change negative, red latest price -->
        <div *ngIf="changePercent < 0" class="row mr-1 flex-row justify-content-end">
          <div class="row m-0 p-0">
            <svg width="2em" height="2em" viewBox="0 0 16 16" class="bi bi-caret-up-fill" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
              <path class="neg" d="M7.247 4.86l-4.796 5.481c-.566.647-.106 1.659.753 1.659h9.592a1 1 0 0 0 .753-1.659l-4.796-5.48a1 1 0 0 0-1.506 0z"/>
            </svg>
            <h2 class="m-0 p-0 d-flex flex-row-reverse text-danger" id="change-latest-neg">{{ change | number: "1.2-2" }}</h2>
          </div>
          <div class="col-sm m-0 p-0 col-md-auto"><h2 class="m-0 p-0 d-flex flex-row-reverse text-danger" id="change-latest-neg">({{ changePercent | number: "1.2-2" }}%)</h2></div>
        </div>

        <h4 class="m-0 p-0 font-weight-light d-flex flex-row-reverse">
          {{ localCurrentTime | date: "yyyy-MM-dd H:mm:ss":"-0700" }}
        </h4>
      </div>
    </div>
    <div class="row">
      <div
        *ngIf="openstatus"
        class="alert alert-success border-0 p-0 d-inline-flex mx-auto"
        role="alert"
      >
        Market is Open
      </div>
      <div
        *ngIf="!openstatus"
        class="alert alert-danger border-0 p-0 d-inline-flex mx-auto"
        role="alert"
      >
        Market Closed on
        {{ lasttimestamp | date: "yyyy-MM-dd H:mm:ss":"-0700" }}
      </div>
    </div>
  </div>

  <mat-tab-group mat-stretch-tabs>
    <!-- summary tab -->
    <mat-tab label="Summary">
      <div class="container" id="summary-content">
        <div class="row flex-row mt-4">
          <div class="col-sm">
            <div class="row ml-1">
              <div class="col p-0">
                <p class="m-0">High Price:&#160; {{ latestprice.high }}</p>
                <p class="m-0">Low Price:&#160;&#160; {{ latestprice.low }}</p>
                <p class="m-0">Open Price: {{ latestprice.open }}</p>
                <p class="m-0">Prev. Close: {{ latestprice.prevClose }}</p>
                <p class="m-0">Volume:&#160;&#160;&#160;&#160;&#160;&#160; {{ latestprice.volume }}</p>
              </div>
              <div class="col p-0">
                <p *ngIf="latestprice.mid" class="m-0"> Mid Price: {{ latestprice.mid }}</p>
                <p *ngIf="!latestprice.mid && latestprice.askPrice" class="m-0">Mid Price: -</p>
                <p *ngIf="latestprice.askPrice" class="m-0">Ask Price: {{ latestprice.askPrice }}</p>
                <p *ngIf="latestprice.askSize" class="m-0">Ask Size:&#160;&#160; {{ latestprice.askSize }}</p>
                <p *ngIf="latestprice.bidPrice" class="m-0">Bid Price:&#160; {{ latestprice.bidPrice }}</p>
                <p *ngIf="latestprice.bidSize" class="m-0">Bid Size:&#160;&#160;&#160; {{ latestprice.bidSize }}</p>
              </div>
            </div>

            <!-- company description row -->
            <div class="row mt-5">
              <h2 class="row mt-1 mx-auto">Company's Description</h2>
            </div>
            <p class="row">Start Date: {{ metadata.startDate }}</p>
            <p class="row">{{ metadata.description }}</p>
          </div>

          <div class="col-sm">daily charts</div>
        </div>
      </div>
    </mat-tab>

    <!-- news tab -->
    <mat-tab label="Top News">
      <div class="container border" id="news-content">
        <div class="row p-1" *ngIf="allnews">
          <div class="card col-md-5 m-2 bg-light mx-auto" *ngFor="let news of allnews">
            <div class="card-body border">
              <!-- <img class="card-img" src="{{ news.urlToImage }}" alt="Card image cap"> -->
              <h5 class="card-title">{{ news.title }}</h5>
            </div>
          </div>
        </div>
      </div>
    </mat-tab>

    <!-- charts tab -->
    <mat-tab label="Charts">
      <div class="container" id="charts-content"></div>
    </mat-tab>
  </mat-tab-group>
</div>

<!-- if ticker does not exist, show message -->
<div *ngIf="metadata && !metadata.ticker" class="container mt-5">
  <div class="alert alert-danger text-center text-dark" role="alert">
    No results found. Please enter valid Ticker
  </div>
</div>
